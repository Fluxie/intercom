[
    uuid(12341234-1234-1234-1234-123412340000),
    helpstring("RustCom Library"),
    lcid(0x09),
    version(1.0)
]
library Calculator
{
    [
        object,
        uuid(12341234-1234-1234-1234-123412340002),
        nonextensible,
        helpstring("ICalculator interface"),
        pointer_default(unique)
    ]
    interface ICalculator : IUnknown
    {
        [id(1), helpstring( "Add value" )]
        HRESULT Add([in] int value, [out, retval] int* result);

        [id(2), helpstring( "Substract" )]
        HRESULT Substract([in] int value, [out, retval] int* result);

        [id(3), helpstring( "Multiply value" )]
        HRESULT Multiply([in] int value, [out, retval] int* result);
    };

    [
        object,
        uuid(12341234-1234-1234-1234-123412340003),
        nonextensible,
        helpstring("IMemory interface"),
        pointer_default(unique)
    ]
    interface IMemory : IUnknown
    {
        [id(1), helpstring( "Stores current value" )]
        HRESULT Store([out, retval] size_t* slot);

        [id(2), helpstring( "Recalls previously stored value" )]
        HRESULT Recall([in] size_t value );
    };

    importlib("stdole2.tlb");
    [
        uuid(12341234-1234-1234-1234-123412340001),
        version(1.0),
        helpstring( "Calculator class" )
    ]
    coclass Calculator
    {
        [default] interface ICalculator;
    }
}
